<?xml version="1.0" encoding="utf-8" ?>
<Patch>
<!-- REBALANCE -->
<!-- allowed items -->
    <!-- tent -->
    <Operation Class="PatchOperationAdd">
        <xpath>Defs/ThingDef[defName="ASF_StorageTent"]/building</xpath>
        <value>
            <fixedStorageSettings>
                <filter>
                    <disallowNotEverStorable>true</disallowNotEverStorable>
                    <categories>
                        <li>Root</li>
                    </categories>
                    <disallowedCategories>
                        <li>Foods</li>
                        <li>Chunks</li>
                        <li>Corpses</li>
                        <li>Buildings</li>
                    </disallowedCategories>
                </filter>
            </fixedStorageSettings>
        </value>
    </Operation>
    <Operation Class="PatchOperationAdd">
        <xpath>Defs/ThingDef[defName="ASF_StorageTent"]/building</xpath>
        <value>
            <defaultStorageSettings>
                <priority>Preferred</priority>
                <filter>
                    <categories>
                        <li>Root</li>
                    </categories>
                    <disallowedCategories>
                        <li>Foods</li>
                        <li>Chunks</li>
                        <li>Corpses</li>
                        <li>Buildings</li>
                    </disallowedCategories>
                </filter>
            </defaultStorageSettings>
        </value>
    </Operation>
    <!-- cellar -->
    <Operation Class="PatchOperationAdd">
        <xpath>Defs/ThingDef[defName="ASF_StoragePit" or defName="ASF_CellarWood" or defName="ASF_CellarStone"]/building</xpath>
        <value>
            <fixedStorageSettings>
                <filter>
                    <disallowNotEverStorable>true</disallowNotEverStorable>
                    <categories>
                        <li>Root</li>
                    </categories>
                    <disallowedCategories>
                        <li>Chunks</li>
                        <li>Buildings</li>
                    </disallowedCategories>
                </filter>
            </fixedStorageSettings>
        </value>
    </Operation>
    <Operation Class="PatchOperationAdd">
        <xpath>Defs/ThingDef[defName="ASF_StoragePit" or defName="ASF_CellarWood" or defName="ASF_CellarStone"]/building</xpath>
        <value>
            <defaultStorageSettings>
                <priority>Preferred</priority>
                <filter>
                    <categories>
                        <li>Root</li>
                    </categories>
                    <disallowedCategories>
                        <li>Chunks</li>
                        <li>Buildings</li>
                    </disallowedCategories>
                </filter>
            </defaultStorageSettings>
        </value>
    </Operation>
    <!-- basket -->
    <Operation Class="PatchOperationAdd">
        <xpath>Defs/ThingDef[defName="ASF_WovenBasket" or defName="ASF_WovenBasketDouble" or defName="ASF_WovenBasketTriple"]/building</xpath>
        <value>
            <fixedStorageSettings>
                <filter>
                    <disallowNotEverStorable>true</disallowNotEverStorable>
                    <categories>
                        <li>Root</li>
                    </categories>
                    <disallowedCategories>
                        <li>Chunks</li>
                        <li>Corpses</li>
                        <li>Buildings</li>
                    </disallowedCategories>
                </filter>
            </fixedStorageSettings>
        </value>
    </Operation>
    <Operation Class="PatchOperationAdd">
        <xpath>Defs/ThingDef[defName="ASF_WovenBasket" or defName="ASF_WovenBasketDouble" or defName="ASF_WovenBasketTriple"]/building</xpath>
        <value>
            <defaultStorageSettings>
                <priority>Preferred</priority>
                <filter>
                    <categories>
                        <li>Root</li>
                    </categories>
                    <disallowedCategories>
                        <li>Chunks</li>
                        <li>Corpses</li>
                        <li>Buildings</li>
                    </disallowedCategories>
                </filter>
            </defaultStorageSettings>
        </value>
    </Operation>

<!-- stacks -->
    <!-- Cellars -->
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_StoragePit"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>6</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_StoragePit"]/description</xpath>
        <value>
        <description>A dirt dugout that can store a range of items. Keeps perishable items slightly cooler underground, effective at around 65F/18C. Items stored inside will never deteriorate and don't affect the beauty of their surroundings. \nOccupies a 1x1 area underground.\n\nTotal Capacity: 6 Stacks</description>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_CellarWood"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>9</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_CellarWood"]/costStuffCount</xpath>
        <value>
            <costStuffCount>100</costStuffCount>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_CellarWood"]/description</xpath>
        <value>
            <description>A wooden cellar that can store a range of items. Keeps perishable items slightly cooler underground, effective at around 65F/18C. Items stored inside will never deteriorate and don't affect the beauty of their surroundings. \nOccupies a 3x3 area underground. \n\nTotal Capacity: 9 Stacks</description>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_CellarStone"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>12</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_CellarStone"]/costStuffCount</xpath>
        <value>
            <costStuffCount>75</costStuffCount>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_CellarStone"]/description</xpath>
        <value>
            <description>A stone cellar stone that can store a range of items. Keeps perishable items slightly cooler underground, effective at around 74F/23C. Items stored inside will never deteriorate and don't affect the beauty of their surroundings. \nOccupies a 3x3 area underground. \n\nTotal Capacity: 175 Stacks</description>
        </value>
    </Operation>
    <!-- Pots -->
    <!--
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_CoveredClayPot"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>3</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_CoveredClayPot"]/description</xpath>
        <value>
        <description>A clay pot designed for storing various items. Items stored inside do not affect the beauty of their surroundings.\n\nTotal Capacity: 3</description>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_UncoveredClayPot"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>3</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_UncoveredClayPot"]/description</xpath>
        <value>
        <description>A clay pot designed for storing various items. Items stored inside do not affect the beauty of their surroundings.\n\nTotal Capacity: 3</description>
        </value>
    </Operation>
    -->
    <!-- Granary -->
    <!--
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_Granary"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>6</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_Granary"]/description</xpath>
        <value>
        <description>A granary for keeping food dry. Items stored inside will never deteriorate and don't affect the beauty of their surroundings.\n\nTotal Capacity: 54 Stacks</description>
        </value>
    </Operation>
    -->
    <!-- Log Piles -->
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_SmallLogPile"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>3</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_SmallLogPile"]/description</xpath>
        <value>
        <description>A designated spot to pile wood. Free to build. Deconstructing returns 100% of wood logs stored. Items stored inside will never deteriorate and don't affect the beauty of their surroundings. \n\nTotal Capacity: 3 Stacks\n\nDynamic Textures</description>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/AdaptiveStorage.GraphicsDef[defName="SmallLogPileGraphics"]/graphics/li[graphicData/texPath="SmallLogPile/SmallLogPile_F"]/minimumStackCount</xpath>
        <value>
            <minimumStackCount>3</minimumStackCount>
        </value>
    </Operation>
    <!--
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_LargeLogPile"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>4</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_LargeLogPile"]/description</xpath>
        <value>
        <description>A designated spot to pile wood. Free to build. Deconstructing returns 100% of wood logs stored. Items stored inside will never deteriorate and don't affect the beauty of their surroundings. \n\nTotal Capacity: 12 Stacks\n\nDynamic Textures</description>
        </value>
    </Operation>
    -->
    <!-- Meat Rack -->
    <!--
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_MeatRack"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>3</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_MeatRack"]/description</xpath>
        <value>
        <description>Sturdy pieces of wood lashed together with leather or fabric for storing large quantities of meat off the ground. Does not prevent meat deterioration. Doesn't prevent meat from affecting the beauty of its surroundings \n\nTotal Capacity: 6 Stacks\n\nDynamic Textures</description>
        </value>
    </Operation>
    -->
    <!-- Tent -->
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_StorageTent"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>2</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_StorageTent"]/costStuffCount</xpath>
        <value>
            <costStuffCount>50</costStuffCount>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_StorageTent"]/description</xpath>
        <value>
        <description>A tent that can store a variety of items. Items stored inside will never deteriorate and don't affect the beauty of their surroundings.\n\nTotal Capacity: 18 Stacks</description>
        </value>
    </Operation>
    <!-- Weapon Rack -->
    <!--
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_WeaponRack"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>3</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_WeaponRack"]/description</xpath>
        <value>
        <description>Sturdy pieces of wood lashed together with leather or fabric for storing large quantities of weaponry. Does not prevent deterioration. Prevents weaponry from affecting the beauty of its surroundings. \n\nTotal Capacity: 6 Stacks</description>
        </value>
    </Operation>
    -->
    <!-- Baskets -->
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_WovenBasket"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>1</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_WovenBasket"]/costList/Hay</xpath>
        <value>
            <Hay>10</Hay>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_WovenBasket"]/description</xpath>
        <value>
        <description>A woven basket designed for storing various items. Items stored inside do not affect the beauty of their surroundings.\n\nTotal Capacity: 1 Stack\n\nRotate to change appearance.</description>
        <fillPercent>0.15</fillPercent>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_WovenBasketDouble"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>2</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_WovenBasketDouble"]/costList/Hay</xpath>
        <value>
            <Hay>20</Hay>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_WovenBasketDouble"]/description</xpath>
        <value>
        <description>A stack of two woven baskets designed for storing various items. Items stored inside do not affect the beauty of their surroundings.\n\nTotal Capacity: 2 Stacks</description>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_WovenBasketTriple"]/building/maxItemsInCell</xpath>
        <value>
            <maxItemsInCell>3</maxItemsInCell>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_WovenBasketTriple"]/costList/Hay</xpath>
        <value>
            <Hay>30</Hay>
        </value>
    </Operation>
    <Operation Class="PatchOperationReplace">
        <xpath>Defs/ThingDef[defName="ASF_WovenBasketTriple"]/description</xpath>
        <value>
        <description>A stack of two woven baskets designed for storing various items. Items stored inside do not affect the beauty of their surroundings.\n\nTotal Capacity: 3 Stacks</description>
        </value>
    </Operation>

<!-- FERNY ORGANIZE -->
    <Operation Class="PatchOperationConditional">
        <xpath>Defs/DesignationCategoryDef[defName="Ferny_Storage"]</xpath>
            <match Class="PatchOperationSequence">
                <operations>
                    <li Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="ASF_StoragePit" or defName="ASF_CellarWood" or defName="ASF_CellarStone" or defName="ASF_MeatRack"]</xpath>
                        <value>
                            <designationCategory>Ferny_GeneralStorage</designationCategory>
                        </value>
                    </li>
                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="ASF_StoragePit" or defName="ASF_CellarWood" or defName="ASF_CellarStone" or defName="ASF_MeatRack"]/designationCategory</xpath>
                        <value>
                            <designationCategory>Ferny_GeneralStorage</designationCategory>
                        </value>
                    </li>
                    <li Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="ASF_WeaponRack"]</xpath>
                        <value>
                            <designationCategory>Ferny_GearStorage</designationCategory>
                        </value>
                    </li>
                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="ASF_WeaponRack"]/designationCategory</xpath>
                        <value>
                            <designationCategory>Ferny_GearStorage</designationCategory>
                        </value>
                    </li>
                </operations>
            </match>
            <nomatch Class="PatchOperationSequence">
                <operations>
                    <li Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="ASF_StoragePit" or defName="ASF_CellarWood" or defName="ASF_CellarStone" or defName="ASF_MeatRack" or defName="ASF_WeaponRack"]</xpath>
                        <value>
                            <designationCategory>ASFstorage</designationCategory>
                        </value>
                    </li>
                    <li Class="PatchOperationReplace">
                        <xpath>Defs/ThingDef[defName="ASF_WeaponRack"]/designationCategory</xpath>
                        <value>
                            <designationCategory>ASFstorage</designationCategory>
                        </value>
                    </li>
                </operations>
            </nomatch>
    </Operation>

<!-- REMOVE DUPLICATES -->
<!-- Phanerons -->
    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Phaneron's Basic Storage</li>
        </mods>
        <match Class="PatchOperationSequence">
            <operations>
                <li Class="PatchOperationAdd">
                    <xpath>Defs/ThingDef[defName="ASF_CoveredClayPot" or defName="ASF_UncoveredClayPot"]</xpath>
                    <value>
                        <designationCategory></designationCategory>
                    </value>
                </li>
                <li Class="PatchOperationReplace">
                    <xpath>Defs/ThingDef[defName="ASF_CoveredClayPot" or defName="ASF_UncoveredClayPot"]/designationCategory</xpath>
                    <value>
                        <designationCategory></designationCategory>
                    </value>
                </li>
                <li Class="PatchOperationAdd" MayRequire="oskarpotocki.vanillafactionsexpanded.core">
                    <xpath>Defs/VEF.Buildings.HiddenDesignatorsDef[defName="StorageBalancePatches_HiddenDesignators"]/hiddenDesignators</xpath>
                    <value>
                        <li>ASF_CoveredClayPot</li>
                        <li>ASF_UncoveredClayPot</li>
                    </value>
                </li>
            </operations>
        </match>
    </Operation>
<!-- Reels/Neat -->
    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>[sbz] Neat Storage</li>
        </mods>
        <match Class="PatchOperationSequence">
            <operations>
                <li Class="PatchOperationAdd">
                    <xpath>Defs/ThingDef[defName="ASF_WeaponRack"]</xpath>
                    <value>
                        <designationCategory></designationCategory>
                    </value>
                </li>
                <li Class="PatchOperationReplace">
                    <xpath>Defs/ThingDef[defName="ASF_WeaponRack"]/designationCategory</xpath>
                    <value>
                        <designationCategory></designationCategory>
                    </value>
                </li>
                <li Class="PatchOperationAdd" MayRequire="oskarpotocki.vanillafactionsexpanded.core">
                    <xpath>Defs/VEF.Buildings.HiddenDesignatorsDef[defName="StorageBalancePatches_HiddenDesignators"]/hiddenDesignators</xpath>
                    <value>
                        <li>ASF_WeaponRack</li>
                    </value>
                </li>
            </operations>
        </match>
    </Operation>
    <Operation Class="PatchOperationConditional">
        <xpath>Defs/ThingDef[defName="ReelStorageWeaponRack"]</xpath>
        <match Class="PatchOperationSequence">
            <operations>
                <li Class="PatchOperationAdd">
                    <xpath>Defs/ThingDef[defName="ASF_WeaponRack"]</xpath>
                    <value>
                        <designationCategory></designationCategory>
                    </value>
                </li>
                <li Class="PatchOperationReplace">
                    <xpath>Defs/ThingDef[defName="ASF_WeaponRack"]/designationCategory</xpath>
                    <value>
                        <designationCategory></designationCategory>
                    </value>
                </li>
                <li Class="PatchOperationAdd" MayRequire="oskarpotocki.vanillafactionsexpanded.core">
                    <xpath>Defs/VEF.Buildings.HiddenDesignatorsDef[defName="StorageBalancePatches_HiddenDesignators"]/hiddenDesignators</xpath>
                    <value>
                        <li>ASF_WeaponRack</li>
                    </value>
                </li>
            </operations>
        </match>
    </Operation>
</Patch>